var proxyConfig={loginUrl:"127.0.0.1.3000",payUrl:"127.0.0.1.40001"};proxyConfig.login=function(a,b){return{name:a,pwd:b}};proxyConfig.prototype.getParams=function(b){var a={};a.method=b;a.params=this[b]()||{};return a};
var MyApp=Class("MyApp",puremvc.Facade);MyApp.ViewFolder="app/views/";MyApp.ModelFolder="app/models/";MyApp.CommandFolder="app/commands/";MyApp.prototype.ctor=function(a){this._viewOrder=Const.ZORDER_UI};MyApp.getInstance=function(a){a=a==undefined?0:a;var b=puremvc.Facade.instanceMap;if(puremvc.Facade.instanceMap[a]==null){var c=new MyApp(a);puremvc.Facade.instanceMap[a]=c}return puremvc.Facade.instanceMap[a]};MyApp.prototype.run=function(){cc.log("game start");cc.spriteFrameCache.addSpriteFrames("res/hd/images.plist");this._registeCommand();this.sendNotification("startup")};MyApp.prototype.update=function(a){for(var b in this.view.mediatorMap){if(b&&b.onUpdate){b.onUpdate(a)}}};MyApp.prototype._registeCommand=function(){this.registerCommand("startup",startupCommand)};MyApp.prototype.getView=function(a){return this.retrieveMediator(a)};MyApp.prototype.removeView=function(a){this.removeMediator(a)};MyApp.prototype.getData=function(a){var c=this.retrieveProxy(a);if(c==null){var b=ClassManager[a];if(b){c=new b();this.registerProxy(c)}}return c};MyApp.prototype.createView=function(h,g){cc.log("createView("+Array.prototype.join.call(arguments,",")+")");var d=true;var f=Array.prototype.slice.call(arguments,2);if(f[0]&&typeof(f[0])=="boolean"){d=f[0]}else{f.unshift(d)}var c=this.retrieveMediator(g);if(c==null){var b=null;if(h){b=new cc.Scene();this.runningScene=b}var a=g.split("_");var e=ClassManager[a[0]];if(!e){c=new ViewBase(a[0],b)}else{c=new e(a[0],b)}this.registerMediator(c);cc.log("==="+f.join("*"));c.init.apply(c,f)}if(d){f.shift();c.show.apply(c,f);if(!h){if(c.getOption("isHideOther")){if(this.currentView){this.currentView.close();this.currentView=null}}if(c.getOption("mode")===ViewBase.UIMODE_NORMAL){this.currentView=c;cc.log("currentView: "+c.NAME)}}}return c};MyApp.prototype.addView=function(b){var a=Array.prototype.unshift.call(arguments,false);return this.createView.apply(this,arguments)};MyApp.prototype.runScene=function(a){Array.prototype.unshift.call(arguments,true);
return this.createView.apply(this,arguments)};
var mainScene=Class("mainScene",ViewBase);mainScene.prototype.initOptions=function(){this.setOption("mode",ViewBase.MODE_SCENE);this.setOption("isHideOther",false);this.setOption("showAction","sceneFade");this.setOption("bindUI","uiMain")};mainScene.prototype.onCreate=function(){this.randomColor();this.delay=0};mainScene.prototype.fresh=function(){cc.log("mainScene fresh")};mainScene.prototype.onShown=function(){cc.log("mainScene onShown")};mainScene.prototype.randomColor=function(){var a=this.getChildByName("Panel_root");a.setColor(cc.color(Rand(20,255),Rand(20,255),Rand(20,255)))};mainScene.prototype.onRemoved=function(){};mainScene.prototype.onTouchBegan=function(a,b){cc.log("onTouchBegan. ",a,b);return true};mainScene.prototype.onTouchMoved=function(a,b){cc.log("onTouchMoved. ",a,b)};mainScene.prototype.onTouchEnded=function(a,b){cc.log("onTouchEnded. ",a,b)};
var DataProxy=Class("DataProxy",puremvc.Proxy);DataProxy.prototype.ctor=function(a,b){this._params=b||{};this._data={}};DataProxy.prototype.onRegister=function(){this.send()};DataProxy.prototype.send=function(){var b=this;var c=new cc.XMLHttpRequest();c.responseType=cc.XMLHTTPREQUEST_RESPONSE_JSON;c.open("POST",proxyConfig.loginUrl);var a=function(){var d=c.status;var f=c.readyState;cc.log(this.NAME+" [Post] status."+d+"state."+f);if(c.readyState==4&&(c.status>=200&&c.status<207)){var e=c.response;if(e.error){cc.log(e.error)}else{this._data=e;this.sendNotification(this.NAME,c.response)}}else{cc.log(this.NAME+" [Post] error."+d+"state."+f)}};c.registerScriptHandler(a);c.send(proxyConfig.getParams(this.NAME))};DataProxy.prototype.getData=function(a){if(a||this.data==null){this.send()}else{this.sendNotification(this.NAME+"_Complete",this._data)}};
var Const={};Const.Language="cn";Const.ZORDER_UI=1000;Const.ZORDER_TOP=10000;
var Component=cc.Layer.extend({ctor:function(a,b){this._super();this._resourceFilename=a;this.NAME=a;if(b){this.setDelegate(b)}this.createResource()},onEnter:function(){this._super();cc.log(this._delegate.NAME+" onEnter");if(this._delegate.onUpdate){this.scheduleUpdate()}}});Component.prototype.createResource=function(){cc.log(this._resourceFilename);var b=ccs.load("res/sd_other/"+this._resourceFilename+".json");var a=b.node;if(!a){a=new cc.Node()}this.addChild(a);if(this._delegate){this.bindEvent(a)}LogNodesName(this)};Component.prototype.update=function(a){this._delegate.onUpdate(a)};Component.prototype.setDelegate=function(a){this._delegate=a;this.isScene=a.getOption("mode")==ViewBase.MODE_SCENE};Component.prototype.touchEnabled=function(a){if(!a&&this._touchListener){cc.eventManager.removeListener(this._touchListener);this._touchListener=null;return}this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)});cc.eventManager.addListener(this._touchListener,this)};Component.prototype.onTouchBegan=function(d,a){cc.log("touchMoved "+this._resourceFilename);var b=a.getCurrentTarget();var c=b.convertToNodeSpace(d.getLocation());return this._delegate.onTouchEvent(c,"began",b)};Component.prototype.onTouchMoved=function(d,a){var b=a.getCurrentTarget();var c=d.getDelta();cc.log("touchMoved "+this._resourceFilename+c.x+","+c.y);return this._delegate.onTouchEvent(c,"moved",b)};Component.prototype.onTouchEnded=function(d,a){cc.log("touchEnded "+this._resourceFilename);var b=a.getCurrentTarget();var c=b.convertToNodeSpace(d.getLocation());return this._delegate.onTouchEvent(c,"ended",b)};Component.prototype.addChild=function(c,b,a){if(this._resourceNode!=null){this._resourceNode.addChild(c,b||0,a||0)}else{this._resourceNode=c;cc.Layer.prototype.addChild.call(this,c,b||0,a||0)}};Component.prototype.findChild=function(b,a){a=a||this._resourceNode;
var d=b.split("/");for(var c=0;c<d.length;c++){a=a.getChildByName(d[c]);if(a==null){cc.log("[Warn] node not find . "+d[c]);return null}}return a};Component.prototype.buttonEvent=function(a,b){this._delegate.buttonClick(a,b)};Component.prototype.textInputEvent=function(a,b){cc.log(a.name+b)};Component.prototype.valueChangedEvent=function(a,b){cc.log(a.name+b)};Component.prototype.checkBoxEvent=function(a,b){cc.log(a.name+b)};Component.prototype.scrollEvent=function(a,b){cc.log(a.name+b)};Component.prototype.onPageEvent=function(a,b){cc.log(a.name+b)};Component.prototype.bindEvent=function(b,a){a=a||this;var d=b.getChildren();for(var c=0;c<d.length;c++){if(d[c] instanceof ccui.Button&&a._delegate.buttonClick){d[c].addTouchEventListener(a.buttonEvent,a)}else{if(d[c] instanceof ccui.CheckBox&&a._delegate.checkBoxEvent){d[c].addEventListener(a.checkBoxEvent,a)}else{if(d[c] instanceof ccui.Slider&&a._delegate.valueChangedEvent){d[c].addEventListener(a.valueChangedEvent,a);d[c].addTouchEventListener(a.buttonEvent,a)}else{if(d[c] instanceof ccui.TextField&&a._delegate.textInputEvent){d[c].addTouchEventListener(a.textInputEvent,a)}else{if(d[c] instanceof ccui.ScrollView){if(a._delegate.scrollEvent){d[c].addEventListener(a.scrollEvent,a)}this.bindEvent(d[c],a)}else{if(d[c] instanceof ccui.PageView){if(a._delegate.onPageEvent){d[c].addEventListener(a.onPageEvent,a)}this.bindEvent(d[c],a)}else{this.bindEvent(d[c],a)}}}}}}}};Component.prototype.getRoot=function(){return this._resourceNode};Component.prototype.getChildByTag=function(a){return this._resourceNode.getChildByTag(a)};Component.prototype.remove=function(){this.touchEnabled(false);this.unschedule();this._resourceNode.removeFromParent();this._resourceNode=null};Component.prototype.onEnterTransitionDidFinish=function(){cc.log(this._resourceFilename+" onEnterTransitionDidFinish");if(this.isScene){this._delegate._onShowFinish(true)}};Component.prototype.onExit=function(){cc.log("onExit "+this._resourceFilename)};Component.prototype.onExitTransitionDidStart=function(){};
Component.prototype.onCleanup=function(){};
var AudioMgr={res:"",isMusicOn:true,isEffectOn:true,lastBackgroundMusicFile:Const.MUSIC_MAIN,init:function(){this.isMusicOn=cc.sys.localStorage.getItem("MusicOn")!="off";this.isEffectOn=cc.sys.localStorage.getItem("EffectOn")!="off";this.musicVolume=100;cc.audioEngine.setMusicVolume(this.musicVolume/100)},playBackgroundMusic:function(b){cc.log("this.isMusicOn:"+this.isMusicOn);var a=b||lastBackgroundMusicFile;lastBackgroundMusicFile=a;if(this.isMusicOn){this.setMusicVolume(this.musicVolume,false);cc.audioEngine.playMusic(this.res+a,true)}},pauseBackgroundMusic:function(){if(this.isMusicOn){cc.audioEngine.pauseMusic()}},resumeBackgroundMusic:function(){if(this.isMusicOn){cc.audioEngine.resumeMusic()}},setMusicVolume:function(a,b){b=b==undefined?true:b;cc.audioEngine.setMusicVolume(a/100);if(b){cc.sys.localStorage.setItem("MusicVolume",a);cc.log("save music vol")}this.musicVolume=a},stopBackgroundMusic:function(a){cc.audioEngine.stopMusic(a)},playEffect:function(c,a){if(!this.isEffectOn){return -1}if(a==undefined){a=false}var b=cc.audioEngine.playEffect(this.res+c,a);return b},stopEffect:function(a){cc.audioEngine.stopEffect(a)},preloadEffect:function(a){cc.audioEngine.preloadEffect(a)},unloadEffect:function(a){cc.audioEngine.unloadEffect(a)}};
var AnimationMgr={create:function(d,c,b){var a;if(typeof(c)=="boolean"){a=cc.ParticleSystem.create(d);if(c){a.setAutoRemoveOnFinish(true)}if(b){b.addChild(a,10000)}}else{cc.spriteFrameCache.addSpriteFrames(d);a=plistData.create(d.replace(".plist",""),b);if(c){c.addChild(a)}}return a},framesNode:function(f,a,d,e){var c=this.frames.apply(this,arguments);var b=cc.Sprite.create("#"+f+"_0.png");b.runAction(c)},frames:function(f,c,e){var d=arguments[arguments.length-1];e=typeof(e)=="number"?e:0.08;c=typeof(c)=="boolean"?c:false;var b=this.animate(f,e);var a=[];if(c){b=cc.RepeatForever.create(b)}if(typeof(d)=="function"){a.push(b);a.push(cc.CallFunc.create(d))}if(!c){a.push(cc.RemoveSelf.create())}if(a.length>0){return cc.Sequence.create(a)}return b},animate:function(e,b){cc.spriteFrameCache.addSpriteFrames(e+".plist");var d=[];for(var a=0;a<100;a++){var c=cc.spriteFrameCache.getSpriteFrame(e+"_"+a+".png");if(c){d.push(c)}else{break}}return cc.Animate.create(cc.Animation.create(d,b))},createParticle:function(d,c,a){var b=cc.ParticleSystem.create(d);if(c){b.setAutoRemoveOnFinish(true)}if(a){a.addChild(b)}return b},createClip:function(a,b){a.setAnchorPoint(0,0);a.setPosition(0,0);var c=cc.ClippingNode.create();c.setPosition(0,0);c.setStencil(a);c.setInverted(false);c.setAlphaThreshold(0.05);c.setContentSize(a.getContentSize().width,a.getContentSize().height);if(b){b.addChild(c)}return c},};var plistData=cc.Sprite.extend({sprName:"",callfunc:null,});plistData.create=function(c,b){var a=new plistData();a.setSpriteFrame(c+"_0.png");a.sprName=c;if(b!=undefined){a.play(b)}return a};plistData.prototype.play=function(f,a,b,l,e){l=l||0;e=e||100;f=f||0.08;if(a===undefined){a=false}if(b===undefined){b=true}var d=arguments[arguments.length-1];if(typeof(d)=="function"){this.callfunc=d}var k=[];for(var g=l;g<e;g++){var c=cc.spriteFrameCache.getSpriteFrame(this.sprName+"_"+g+".png");if(c){k.push(c)}else{break}}if(k.length>0){var j=cc.Animate.create(cc.Animation.create(k,f));if(a){j=cc.RepeatForever.create(j)
}else{if(this.callfunc){var h=[];h.push(j);h.push(cc.CallFunc.create(this.callfunc,this));if(b){h.push(cc.RemoveSelf.create())}j=cc.Sequence.create(h)}else{var h=[];h.push(j);if(b){h.push(cc.RemoveSelf.create())}j=cc.Sequence.create(h)}}this.runAction(j)}};
var ViewTransition={};ViewTransition.moveToTop=function(b,c){b.setVisible(true);b.setPosition(0,-cc.winSize.height);var a=cc.sequence(cc.moveTo(0.5,cc.p(0,0)),c);b.runAction(a)};ViewTransition.moveToBtm=function(b,c){var a=cc.sequence(cc.moveTo(0.5,cc.p(0,-cc.winSize.height)),c);b.runAction(a)};ViewTransition.sceneFade=function(b,a){var c=new cc.TransitionFade(0.5,b.getParent(),cc.color(0,0,0));cc.director.runScene(c)};ViewTransition.execute=function(a,b){var f=b?"showAction":"hideAction";var d=ViewTransition[a.getOption(f)];if(d==null){return a._onShowFinish(b)}var c=Array.prototype.slice.call(arguments,1);var e=cc.callFunc(function(){a._onShowFinish(b)});d(a.getViewComponent(),e)};
var viewConfig={uiLogin:["uiLogin.csb",uiLogin]};
var ViewBase=Class("ViewBase",puremvc.Notifier);ViewBase.MODE_NORMAL=0;ViewBase.MODE_MODEL=1;ViewBase.MODE_TRANSPARENTS=2;ViewBase.MODE_SCENE=3;ViewBase.ZORDER=Const.ZORDER_UI;ViewBase.prototype.ctor=function(a,b){this._isShown=false;this._notifications={};this.viewOptions=Clone({mode:ViewBase.UIMODE_NORMAL,autoHideTime:-1,showAction:"moveToTop",hideAction:"moveToBtm",parent:null,zorder:null,initPosition:null,componentName:this.NAME,isAutoRelease:true,isHideOther:true,isClickClose:false,bindUI:null,bindModel:null,});if(b){this.setOption("parent",b)}};ViewBase.prototype.init=function(b){cc.log("ViewInit("+Array.prototype.join.call(arguments,",")+")");this.app=this.getFacade();if(this.initOptions){this.initOptions()}this._componentName=this.getOption("componentName");if(this._componentName){this.viewComponent=new Component(this._componentName,this);var f=this._getInitParent();var a=this.getOption("zorder");if(a==null){a=ViewBase.ZORDER++}f.addChild(this.viewComponent,a);this._setupViewMode();if(!b){this.viewComponent.setVisible(false)}}cc.log(this.NAME+" created ");if(this.onCreate){var c=Array.prototype.slice.call(arguments,1);this.onCreate.apply(this,c)}var e=this.getOption("bindModel");if(e!=null){if(typeof(e)=="string"){e=[e]}for(var d=0;d<e.length;d++){this.bindNotifier(e[d]);this.getFacade().getData(e[d])}}};ViewBase.prototype._setupViewMode=function(){var a=this.getOption("mode");if(a==ViewBase.MODE_TRANSPARENTS){this.viewComponent.touchEnabled(false)}else{if(this.onTouchBegan||this.onTouchMoved||this.onTouchEnded||this.getOption("isClickClose")){this.viewComponent.touchEnabled(true)}}};ViewBase.prototype._getInitParent=function(){var b=this.getOption("parent");if(typeof(b)=="string"){var a=this.getFacade().getView(b);if(a!=null){b=a.getViewComponent();if(b==null){cc.log("[ViewBase] view parent not find "+this.NAME)}}else{return null}}if(b==null){b=this.getFacade().runningScene}return b};ViewBase.prototype.onTouchEvent=function(a,b,c){if(b=="began"){return this.onTouchBegan&&this.onTouchBegan(a.x,a.y,c)
}else{if(b=="moved"){this.onTouchMoved&&this.onTouchMoved(a.x,a.y,c)}else{this.onTouchEnded&&this.onTouchEnded(a.x,a.y,c);if(this.getOption("isClickClose")){this.close()}}}};ViewBase.prototype.getOption=function(a){return this.viewOptions[a]};ViewBase.prototype.setOption=function(a,b){this.viewOptions[a]=b};ViewBase.prototype.show=function(){if(this._isShown){this.onShow()}else{ViewTransition.execute(this,true);this._isShown=true}};ViewBase.prototype.onShow=function(){};ViewBase.prototype.close=function(){if(this.autoHideTime){this.autoHideTime=this.getOption("autoHideTime")}if(this.getOption("isAutoRelease")){this.getFacade().removeMediator(this.NAME)}this.onClose&&this.onClose();ViewTransition.execute(this,false)};ViewBase.prototype._onShowFinish=function(a){cc.log(this.NAME+" showFinish "+a);if(!a){this.onClosed&&this.onClosed();if(this.getOption("isAutoRelease")){this.viewComponent.remove();this.onRelease&&this.onRelease()}else{this.viewComponent.setVisible(false)}}else{if(this.onShown){this.onShown()}var b=this.getOption("bindUI");if(b){this.getFacade().addView(b)}}};ViewBase.prototype.addChild=function(c,b,a){this.viewComponent.addChild(c,b,a)};ViewBase.prototype.buttonClick=function(a,b){cc.log("ButtonClick: "+a.name+b);if(b==ccui.Widget.TOUCH_ENDED){this.onButtonClick&&this.onButtonClick(a)}else{if(b==ccui.Widget.TOUCH_BEGAN){AudioMgr.playEffect(res.okWav);this.onButtonBegan&&this.onButtonBegan(a,b)}else{if(b==ccui.Widget.TOUCH_CANCELED){this.onButtonCanceled&&this.onButtonCanceled(a,b)}}}};ViewBase.prototype.getMediatorName=function(){return this.NAME};ViewBase.prototype.isShown=function(){return this._isShown};ViewBase.prototype.getChildByName=function(b,a){return this.getViewComponent().findChild(b,a)};ViewBase.prototype.getViewComponent=function(){return this.viewComponent};ViewBase.prototype.bindNotifier=function(a){this._notifications=this._notifications.concat(arguments)};ViewBase.prototype.onRegister=function(){};ViewBase.prototype.listNotificationInterests=function(){return this._notifications
};ViewBase.prototype.onRemove=function(){};
var uiMain=Class("uiMain",ViewBase);uiMain.prototype.initOptions=function(){};uiMain.prototype.onCreate=function(){};uiMain.prototype.fresh=function(){cc.log("uiMain fresh")};uiMain.prototype.onShown=function(){cc.log("uiMain onShown")};uiMain.prototype.onClosed=function(){};uiMain.prototype.onRemoved=function(){};uiMain.prototype.onButtonClick=function(a){var b=a.getName();if(b=="Button_start"){this.getFacade().addView("uiGame")}else{if(b="Button_customHead"){this.app.addView("uiCustomFace")}}};uiMain.prototype.textInputEvent=function(a,b){cc.log(a.name+b)};uiMain.prototype.onTouchBegan=function(a,b){return true};uiMain.prototype.onTouchMoved=function(a,b){};uiMain.prototype.onTouchEnded=function(a,b){};
var uiGamePause=Class("uiGamePause",ViewBase);uiGamePause.prototype.initOptions=function(){this.setOption("isHideOther",false);this.setOption("mode",ViewBase.MODE_MODEL)};uiGamePause.prototype.onCreate=function(){};uiGamePause.prototype.fresh=function(){cc.log("uiGamePause fresh")};uiGamePause.prototype.onShown=function(){cc.log("uiGamePause onShown")};uiGamePause.prototype.onClose=function(){};uiGamePause.prototype.onRemoved=function(){};uiGamePause.prototype.onButtonClick=function(a){if(a.getName()=="Button_play"){this.close();this.app.getView("uiGame").play()}else{if(a.getName()=="Button_return"){this.close();this.app.addView("uiMain")}}};uiGamePause.prototype.textInputEvent=function(a,b){cc.log(a.name+b)};
var uiGameOver=Class("uiGameOver",ViewBase);uiGameOver.prototype.initOptions=function(){};uiGameOver.prototype.onCreate=function(e){e=e==undefined?0:e;AudioMgr.stopBackgroundMusic(res.bgMusic);AudioMgr.playEffect(res.gameOverWav);this.maxScore=parseInt(cc.sys.localStorage.getItem("score"))||0;this.score=e;if(e>this.maxScore){this.maxScore=e;cc.sys.localStorage.setItem("score",e)}this.getChildByName("Panel_root/Text_score").setString(this.maxScore);var a=[{title:"太弱了",tip:"火星人的种子不适合在地球"},{title:"好强大",tip:"好傻好天真成就了你的天真"},{title:"真汉子",tip:"你在生物链里的名称叫真汉子"},{title:"真变态",tip:"地球上竟然有如此变态的生物"},{title:"凹凸曼",tip:"恭喜你征服了所有的地球生物"},];var d=a[0];var c=parseInt(this.score/10);for(var b=0;b<a.length;b++){if(c<=b){d=a[b];break}}this.getChildByName("Panel_root/Text_title").setString(d.title);this.getChildByName("Panel_root/Text_tip").setString(d.tip)};uiGameOver.prototype.fresh=function(){cc.log("uiGameOver fresh")};uiGameOver.prototype.onShown=function(){cc.log("uiGameOver onShown")};uiGameOver.prototype.onClose=function(){};uiGameOver.prototype.onRemoved=function(){};uiGameOver.prototype.onButtonClick=function(a){if(a.getName()=="Button_replay"){this.app.addView("uiGame")}else{if(a.getName()=="Button_return"){this.app.addView("uiMain")}}};uiGameOver.prototype.textInputEvent=function(a,b){cc.log(a.name+b)};
var uiGame=Class("uiGame",ViewBase);uiGame.prototype.initOptions=function(){};uiGame.prototype.onCreate=function(){AudioMgr.playBackgroundMusic(res.bgMusic);this.app.getView("mainScene").randomColor();this.sperm=this.getChildByName("Panel_root/sperm");this.tail=this.sperm.getChildByName("sperm_tail");this.tail.runAction(AnimationMgr.frames("sperm",true,0.05));this.scoreLbl=this.getChildByName("Panel_root/Text_score");this.startPos=cc.p(100,cc.winSize.height-200);this.sperm.setPosition(this.startPos);this.score=0;this.spermSpeed=8;this.wallSpeed=300;this.angle=-1;this.isPause=false;this.tailOffsetY=47;this.followSpeed=5;this.walls=[];this.createWalls()};uiGame.prototype.onUpdate=function(d){if(this.isPause||this.walls.length==0){return}this.startPos.x+=-1*this.angle*this.spermSpeed;if(this.startPos.y>cc.winSize.height-300){this.startPos.y+=-1*this.spermSpeed}this.sperm.setPosition(this.startPos);this.followAngle(this.sperm,12);if(this.tail.rotation!=0){if(Math.abs(this.tail.rotation)<3){this.tail.rotation=0}else{this.tail.rotation+=this.angle*3}}if(this.startPos.x<0||this.startPos.x>cc.winSize.width){this.app.addView("uiGameOver");this.isPause=true}this.wallRoot.y+=this.wallSpeed*d;var g=this.walls[0];var e=g.getWorldPosition();if(e.y>=cc.winSize.height-300-g.height/2){var i=g.getChildByName("Image_wall_0");var h=g.getChildByName("Image_wall_1");var c=cc.rect(i.getWorldPosition().x-i.width/2,i.getWorldPosition().y-i.height/2,i.width,i.height);var b=cc.rect(h.getWorldPosition().x-h.width/2,h.getWorldPosition().y-h.height/2,h.width,h.height);var a=cc.rect(this.sperm.x-this.sperm.width/2,this.sperm.y-this.sperm.height/2,this.sperm.width-10,this.sperm.height);if(cc.rectIntersectsRect(c,a)||cc.rectIntersectsRect(b,a)){this.isPause=true;this.app.addView("uiGameOver",this.score);var f=cc.LayerColor.create(cc.color(200,50,100,100),c.width,c.height);this.addChild(f);f.setPosition(c.x,c.y);f=cc.LayerColor.create(cc.color(200,50,100,100),b.width,b.height);this.addChild(f);f.setPosition(b.x,b.y);
f=cc.LayerColor.create(cc.color(200,50,100,100),a.width,a.height);this.addChild(f);f.setPosition(a.x,a.y)}else{if(e.y>cc.winSize.height-300+this.sperm.height){this.walls.shift();this.score++;this.scoreLbl.setString(this.score);AudioMgr.playEffect(res.getWav)}}}};uiGame.prototype.followAngle=function(b,c){if(b.rotation!=this.angle*45){var a=b.rotation+this.angle*c;if(Math.abs(a)>45){a=this.angle*45}b.rotation=a}};var cfg={0:{img:0},9:{img:1},10:{img:0},19:{img:1},20:{img:0,offsetX:50,height:150},21:{img:0,offsetY:20,height:150},25:{img:0,offsetY:300},30:{img:0},32:{img:1},33:{img:0,},34:{img:1},35:{img:0},36:{img:1},37:{img:0},40:{img:1,offsetX:50,height:150},41:{img:1,offsetX:50,offsetY:20,height:150},};uiGame.prototype.createWalls=function(){var l=this.getChildByName("Panel_root/Panel_wall");var j={};var k=new cc.Node();this.addChild(k);var a=300;for(var g=0;g<50;g++){if(cfg[g]){j=cfg[g]}var f=j.offsetY||300;var h=j.offsetX||240;a-=f;var e=l.clone();e.setVisible(true);e.y=a;this.walls.push(e);var d=e.getChildByName("Image_wall_0");var c=e.getChildByName("Image_wall_1");if(j.height){e.height=j.height;d.height=j.height;c.height=j.height;a-=j.height}else{e.x=Rand(-d.width/2,d.width/2-5)}if(j.img==1){d.loadTexture("zudangwu_2.png",ccui.Widget.PLIST_TEXTURE);c.loadTexture("zudangwu_2.png",ccui.Widget.PLIST_TEXTURE);var m=cc.MoveTo.create(10,cc.p(-d.width/2+10,a));var b=cc.MoveTo.create(10,cc.p(d.width/2-10,a));e.runAction(cc.RepeatForever.create(cc.Sequence.create(m,b)))}k.addChild(e)}a-=cc.winSize.height+300;this.wallRoot=k;this.distance=-a};uiGame.prototype.play=function(){this.isPause=false};uiGame.prototype.onRemoved=function(){};uiGame.prototype.onButtonClick=function(a){if(a.getName()=="Button_pause"){this.getFacade().addView("uiGamePause");this.isPause=true}};uiGame.prototype.onTouchBegan=function(a,b){this.tail.rotation=this.angle*45;this.angle*=-1;return true};uiGame.prototype.onTouchMoved=function(a,b){};uiGame.prototype.onTouchEnded=function(a,b){};
var uiCustomFace=Class("uiCustomFace",ViewBase);uiCustomFace.prototype.initOptions=function(){};uiCustomFace.prototype.onCreate=function(){};uiCustomFace.prototype.fresh=function(){cc.log("uiCustomFace fresh")};uiCustomFace.prototype.onShown=function(){cc.log("uiCustomFace onShown")};uiCustomFace.prototype.onClose=function(){};uiCustomFace.prototype.onRemoved=function(){};uiCustomFace.prototype.onButtonClick=function(a){if(a.getName()=="Button_ok"){this.app.addView("uiMain")}};uiCustomFace.prototype.textInputEvent=function(a,b){cc.log(a.name+b)};uiCustomFace.prototype.onTouchBegan=function(a,b){return true};uiCustomFace.prototype.onTouchMoved=function(a,b){};uiCustomFace.prototype.onTouchEnded=function(a,b){};
var startupCommand=Class("startupCommand",puremvc.SimpleCommand);startupCommand.prototype.execute=function(){MyApp.getInstance().runScene("mainScene")};
var res={imagePlist:"res/sd_other/images.plist",image:"res/sd_other/images.png",sperm:"res/sd_other/sperm.plist",spermpng:"res/sd_other/sperm.png",mainScene:"res/sd_other/mainScene.json",uiMain:"res/sd_other/uiMain.json",uiGame:"res/sd_other/uiGame.json",uiCustomFace:"res/sd_other/uiCustomFace.json",uiGamePause:"res/sd_other/uiGamePause.json",uiGameOver:"res/sd_other/uiGameOver.json",particle1:"res/sd_other/piaofuwu_1.png",particle2:"res/sd_other/piaofuwu_2.png",bgMusic:"res/sd_other/zoidtrip.mp3",okWav:"res/sd_other/Ok.wav",gameOverWav:"res/sd_other/Gameover.wav",getWav:"res/sd_other/Get.wav",ttf:"res/sd_other/hanyimanbu.ttf",};var g_resources=[];for(var i in res){g_resources.push(res[i])};
(function(n){if(null==n){n=window}if(n.puremvc){return}function d(p,q){this.setNotifyMethod(p);this.setNotifyContext(q)}d.prototype.setNotifyMethod=function(p){this.notify=p};d.prototype.setNotifyContext=function(p){this.context=p};d.prototype.getNotifyMethod=function(){return this.notify};d.prototype.getNotifyContext=function(){return this.context};d.prototype.notifyObserver=function(p){this.getNotifyMethod().call(this.getNotifyContext(),p)};d.prototype.compareNotifyContext=function(p){return p===this.context};d.prototype.notify=null;d.prototype.context=null;function l(q,p,r){this.name=q;this.body=p;this.type=r}l.prototype.getName=function(){return this.name};l.prototype.setBody=function(p){this.body=p};l.prototype.getBody=function(){return this.body};l.prototype.setType=function(p){this.type=p};l.prototype.getType=function(){return this.type};l.prototype.toString=function(){var p="Notification Name: "+this.getName();p+="\nBody:"+((this.body==null)?"null":this.body.toString());p+="\nType:"+((this.type==null)?"null":this.type);return p};l.prototype.name=null;l.prototype.type=null;l.prototype.body=null;function i(){}i.prototype.sendNotification=function(s,p,r){var q=this.getFacade();if(q){q.sendNotification(s,p,r)}};i.prototype.facade;i.prototype.initializeNotifier=function(p){this.multitonKey=String(p);this.facade=this.getFacade()};i.prototype.getFacade=function(){if(this.multitonKey==null){throw new Error(i.MULTITON_MSG)}return m.getInstance(this.multitonKey)};i.prototype.multitonKey=null;i.MULTITON_MSG="multitonKey for this Notifier not yet initialized!";function h(){}h.prototype=new i;h.prototype.constructor=h;h.prototype.execute=function(p){};function j(){this.subCommands=[];this.initializeMacroCommand()}j.prototype=new i;j.prototype.constructor=j;j.prototype.subCommands=null;j.prototype.initializeMacroCommand=function(){};j.prototype.addSubCommand=function(p){this.subCommands.push(p)};j.prototype.execute=function(p){while(this.subCommands.length>0){var q=this.subCommands.shift();
var r=new q;r.initializeNotifier(this.multitonKey);r.execute(p)}};function k(p,q){this.mediatorName=p||this.constructor.NAME;this.viewComponent=q}k.NAME="Mediator";k.prototype=new i;k.prototype.constructor=k;k.prototype.getMediatorName=function(){return this.mediatorName};k.prototype.setViewComponent=function(p){this.viewComponent=p};k.prototype.getViewComponent=function(){return this.viewComponent};k.prototype.listNotificationInterests=function(){return[]};k.prototype.handleNotification=function(p){return};k.prototype.onRegister=function(){return};k.prototype.onRemove=function(){return};k.prototype.mediatorName=null;k.prototype.viewComponent=null;function f(q,p){this.proxyName=q||this.constructor.NAME;if(p!=null){this.setData(p)}}f.NAME="Proxy";f.prototype=new i;f.prototype.constructor=f;f.prototype.getProxyName=function(){return this.proxyName};f.prototype.setData=function(p){this.data=p};f.prototype.getData=function(){return this.data};f.prototype.onRegister=function(){return};f.prototype.onRemove=function(){return};f.prototype.proxyName=null;f.prototype.data=null;function m(p){if(m.instanceMap[p]!=null){throw new Error(m.MULTITON_MSG)}this.initializeNotifier(p);m.instanceMap[p]=this;this.initializeFacade()}m.prototype.initializeFacade=function(){this.initializeModel();this.initializeController();this.initializeView()};m.getInstance=function(p){if(null==p){return null}if(m.instanceMap[p]==null){m.instanceMap[p]=new m(p)}return m.instanceMap[p]};m.prototype.initializeController=function(){if(this.controller!=null){return}this.controller=c.getInstance(this.multitonKey)};m.prototype.initializeModel=function(){if(this.model!=null){return}this.model=b.getInstance(this.multitonKey)};m.prototype.initializeView=function(){if(this.view!=null){return}this.view=a.getInstance(this.multitonKey)};m.prototype.registerCommand=function(p,q){this.controller.registerCommand(p,q)};m.prototype.removeCommand=function(p){this.controller.removeCommand(p)};m.prototype.hasCommand=function(p){return this.controller.hasCommand(p)
};m.prototype.registerProxy=function(p){this.model.registerProxy(p)};m.prototype.retrieveProxy=function(p){return this.model.retrieveProxy(p)};m.prototype.removeProxy=function(q){var p=null;if(this.model!=null){p=this.model.removeProxy(q)}return p};m.prototype.hasProxy=function(p){return this.model.hasProxy(p)};m.prototype.registerMediator=function(p){if(this.view!=null){this.view.registerMediator(p)}};m.prototype.retrieveMediator=function(p){return this.view.retrieveMediator(p)};m.prototype.removeMediator=function(p){var q=null;if(this.view!=null){q=this.view.removeMediator(p)}return q};m.prototype.hasMediator=function(p){return this.view.hasMediator(p)};m.prototype.sendNotification=function(r,p,q){this.notifyObservers(new l(r,p,q))};m.prototype.notifyObservers=function(p){if(this.view!=null){this.view.notifyObservers(p)}};m.prototype.initializeNotifier=function(p){this.multitonKey=p};m.hasCore=function(p){return m.instanceMap[p]!=null};m.removeCore=function(p){if(m.instanceMap[p]==null){return}b.removeModel(p);a.removeView(p);c.removeController(p);delete m.instanceMap[p]};m.prototype.controller=null;m.prototype.model=null;m.prototype.view=null;m.prototype.multitonKey=null;m.instanceMap=[];m.MULTITON_MSG="Facade instance for this Multiton key already constructed!";function a(p){if(a.instanceMap[p]!=null){throw new Error(a.MULTITON_MSG)}this.multitonKey=p;a.instanceMap[this.multitonKey]=this;this.mediatorMap=[];this.observerMap=[];this.initializeView()}a.prototype.initializeView=function(){return};a.getInstance=function(p){if(null==p){return null}if(a.instanceMap[p]==null){a.instanceMap[p]=new a(p)}return a.instanceMap[p]};a.prototype.registerObserver=function(q,p){if(this.observerMap[q]!=null){this.observerMap[q].push(p)}else{this.observerMap[q]=[p]}};a.prototype.notifyObservers=function(r){if(this.observerMap[r.getName()]!=null){var t=this.observerMap[r.getName()],s=[],p;for(var q=0;q<t.length;q++){p=t[q];s.push(p)}for(var q=0;q<s.length;q++){p=s[q];p.notifyObserver(r)
}}};a.prototype.removeObserver=function(r,q){var s=this.observerMap[r];for(var p=0;p<s.length;p++){if(s[p].compareNotifyContext(q)==true){s.splice(p,1);break}}if(s.length==0){delete this.observerMap[r]}};a.prototype.registerMediator=function(r){if(this.mediatorMap[r.getMediatorName()]!=null){return}r.initializeNotifier(this.multitonKey);this.mediatorMap[r.getMediatorName()]=r;var s=r.listNotificationInterests();if(s.length>0){var p=new d(r.handleNotification,r);for(var q=0;q<s.length;q++){this.registerObserver(s[q],p)}}r.onRegister()};a.prototype.retrieveMediator=function(p){return this.mediatorMap[p]};a.prototype.removeMediator=function(p){var r=this.mediatorMap[p];if(r){var s=r.listNotificationInterests();for(var q=0;q<s.length;q++){this.removeObserver(s[q],r)}delete this.mediatorMap[p];r.onRemove()}return r};a.prototype.hasMediator=function(p){return this.mediatorMap[p]!=null};a.removeView=function(p){delete a.instanceMap[p]};a.prototype.mediatorMap=null;a.prototype.observerMap=null;a.instanceMap=[];a.prototype.multitonKey=null;a.MULTITON_MSG="View instance for this Multiton key already constructed!";function b(p){if(b.instanceMap[p]){throw new Error(b.MULTITON_MSG)}this.multitonKey=p;b.instanceMap[p]=this;this.proxyMap=[];this.initializeModel()}b.prototype.initializeModel=function(){};b.getInstance=function(p){if(null==p){return null}if(b.instanceMap[p]==null){b.instanceMap[p]=new b(p)}return b.instanceMap[p]};b.prototype.registerProxy=function(p){p.initializeNotifier(this.multitonKey);this.proxyMap[p.getProxyName()]=p;p.onRegister()};b.prototype.retrieveProxy=function(p){return this.proxyMap[p]};b.prototype.hasProxy=function(p){return this.proxyMap[p]!=null};b.prototype.removeProxy=function(q){var p=this.proxyMap[q];if(p){this.proxyMap[q]=null;p.onRemove()}return p};b.removeModel=function(p){delete b.instanceMap[p]};b.prototype.proxyMap=null;b.instanceMap=[];b.prototype.multitonKey;b.MULTITON_MSG="Model instance for this Multiton key already constructed!";function c(p){if(c.instanceMap[p]!=null){throw new Error(c.MULTITON_MSG)
}this.multitonKey=p;c.instanceMap[this.multitonKey]=this;this.commandMap=new Array();this.initializeController()}c.prototype.initializeController=function(){this.view=a.getInstance(this.multitonKey)};c.getInstance=function(p){if(null==p){return null}if(null==this.instanceMap[p]){this.instanceMap[p]=new this(p)}return this.instanceMap[p]};c.prototype.executeCommand=function(p){var r=this.commandMap[p.getName()];if(r==null){return}var q=new r();q.initializeNotifier(this.multitonKey);q.execute(p)};c.prototype.registerCommand=function(p,q){if(this.commandMap[p]==null){this.view.registerObserver(p,new d(this.executeCommand,this))}this.commandMap[p]=q};c.prototype.hasCommand=function(p){return this.commandMap[p]!=null};c.prototype.removeCommand=function(p){if(this.hasCommand(p)){this.view.removeObserver(p,this);this.commandMap[p]=null}};c.removeController=function(p){delete this.instanceMap[p]};c.prototype.view=null;c.prototype.commandMap=null;c.prototype.multitonKey=null;c.instanceMap=[];c.MULTITON_MSG="controller key for this Multiton key already constructed";var o={global:(function(){return this})(),extend:function(r,p){if("function"!==typeof r){throw new TypeError("#extend- child should be Function")}if("function"!==typeof p){throw new TypeError("#extend- parent should be Function")}if(p===r){return}var q=new Function;q.prototype=p.prototype;r.prototype=new q;return r.prototype.constructor=r},decorate:function(q,r){for(var p in r){q[p]=r[p]}return q}};function e(t,u,y){var q=t.split("."),s=y||o.global,p,x,w;for(var v=0,r=q.length;v<r;v++){p=s;w=q[v];s=(null==s[w]?s[w]={}:s[w])}if(null==u){return s}return p[w]=u}function g(w,x,r){if(!w){w={}}var u=w.name,p=w.parent,q="function"===typeof p,t,s=w.scope||null,v;if("parent" in w&&!q){throw new TypeError("Class parent must be Function")}if(w.hasOwnProperty("constructor")){t=w.constructor;if("function"!==typeof t){throw new TypeError("Class constructor must be Function")}}else{if(q){t=function(){p.apply(this,arguments)}}else{t=new Function
}}if(q){o.extend(t,p)}if(x){v=t.prototype;o.decorate(v,x);v.constructor=t}if(r){o.decorate(t,r)}if(u){if("string"!==typeof u){throw new TypeError("Class name must be primitive string")}e(u,t,s)}return t}n.puremvc={View:a,Model:b,Controller:c,SimpleCommand:h,MacroCommand:j,Facade:m,Mediator:k,Observer:d,Notification:l,Notifier:i,Proxy:f,define:g,declare:e}})(this);
